8.1 XML与数据库 nnXML作为数据交换的标准，更着重于统一数据格式，而不是提供数据库的特性。因此在XML应用中，数据库作为数据管理的位置依然没有改变 nn管理XML数据的方式主要有：传统的关系（或者对象）数据库、中间件和NXD（NativeXML Database）。从技术角度讲，“以数据库（关系型数据库、对象数据库或者是NXD）为存贮手段，以XML为交换载体”的数据管理模式是一种趋势 8.2 XML数据的存储和管理方式nn使用CHAR, VARCHAR或者CLOB, BLOB存储XMLnn将XML数据分解并映射到关系表中进行存储 nn纯XML数据的存储和管理 nn混合方式的数据存储和管理 nn使用CHAR, VARCHAR或者CLOB, BLOB的优点qq可以在关系表中专门设置一个CHAR, VARCHAR或CLOB,BLOB大对象列来存储XML数据 qq可以对层次结构的XML数据进行原封不动地保存，不需要将其中的内容分解并映射到关系表（一个或多个）的多个常规列中进行保存 qq在获取所存储的XML数据时，无论是查询语句的编写还是具体检索过程也都非常简单，能够保证查询的结果与源文档完全一样，而不需要在关系数据库管理系统中进行复杂的连接运算，因为存储时并没有对源XML文档中的数据进行分解 8.2 XML数据的存储和管理方式nn使用CHAR, VARCHAR或者CLOB, BLOB的缺点qqCHAR, VARCHAR或者CLOB, BLOB大对象数据类型并不是专门针对XML数据设计的qq在对文档进行搜索和查询检索时，开销非常大，需要设计新的索引技术提高查询检索的效率 qq大对象的更新操作也非常耗时，因为数据库并没有对大对象数据进行任何解析，即使修改其中很少的内容，也必须更新所有的数据 8.2 XML数据的存储和管理方式nn将XML数据分解并映射到关系表中进行存储的优点qq可以将XML文档中的数据（元素和属性）分解并映射到关系表（一个或多个）的多个常规列中进行保存，从而解决前面所描述的、使用大对象存储XML数据时碰到的检索和更新的效率问题 qqXML数据中所蕴含的层次关系在分解时必须采用适当的机制予以保存，以便能够在查询检索之后，重新构造出与源XML文档基本一致的数据 qq仅使用关系模型，用户可以利用现有的SQL工具和代码来直接访问数据库表中存储的信息，而不需要学习新的层次数据的查询语言、以及相关技术，也不需要引入新的索引机制来处理XML数据 8.2 XML数据的存储和管理方式nn将XML数据分解并映射到关系表中进行存储的缺点qqXML数据中包含了大量嵌套关系、以及一些无规则的结构，在对其进行分解存储时，会产生大量的数据库表，并且表与表之间存在复杂的参照关系（通过主键和外键的关系来保存XML数据之间的层次关系），还可能会使得关系表的规范化难以进行、或者导致关系数据库表中出现大量的空值，这些都增加了数据管理的复杂度 qq在进行查询检索时，一方面需要编写复杂的SQL查询计划（难以开发、以及对其进行优化），以访问分散的数据；另一方面，在执行查询计划时，需要访问大量的数据库表，并进行非常耗时的连接操作，以恢复分解之前数据之间的层次关系，这将使得查询的效率非常低下

纯XML数据的存储和管理的优点qq要想真正实现XML数据的高效存储和管理，就必须摆脱关系模型的约束和束缚，设计并实现层次数据库 qq以层次的格式来存储层次的XML数据（以元素或子树为单位，而不是关系数据库中的表或记录），提供新的查询语言（XQuery），引入新的索引机制（值索引、路径索引），从而避免将层次数据模型映射为关系数据模型所带来的性能、模式管理等方面的问题


NXD（Native XML Database）打破了RDBMS传统数据库一统天下的局面，国外一些机构和公司针对NXD进行了深入地研究开发。NXD从存储、索引、查询等，都围绕XML的特点和标准进行设计 nnNXD没有像关系数据库方法那样繁琐的数据转换，又具有中间件所不具有的数据管理功能，如并发控制、备份和恢复等 nnNXD兼有一般数据库的特性，例如支持事务，并发控制，查询语言，安全机制，二次开发接口等。唯一的不同之处在于其内部存储模型是基于XML文档树形结构，而非关系模型qq文档集合（Document Collection）qq查询语言（Query Language）qq事务、锁和并发（Transaction、Lock、Concurrent）qq索引（Indexed）qq应用程序接口qq往返（Round-trip）8.2 XML数据的存储和管理方式nn纯XML数据的存储和管理的缺点qqNXD的发展也遇到了一些困难，因为无法利用现有的关系数据库中所提供的数据存储、管理、索引、优化、事务处理等成熟的技术，所以必须进行彻底的开发 qqXML数据库的理论基础并不像关系数据库理论那么成熟，XML的相关标准也在不断地发展和完善之中 qq如何实现遗留的关系数据库和NXD之间的数据整合，也是NXD在实际应用过程中所面临的一个挑战 8.2 XML数据的存储和管理方式nnXML 数据存储管理的要求qq需要为XML 数据的处理和访问提供下列支持 nn查询功能nn为XML 数据创建索引nn数据修改功能nn模式支持8.2 XML数据的存储和管理方式nnSQL Server为XML数据的存储和处理提供了广泛支持 qq引入XML数据类型 qq支持无类型和有类型的XML数据 qq可以为XML列创建索引 8.3 DB产品中的XMLnnDB2中的pureXMLqq存储方面：混合型模型将XML数据存储在经过解析的DOM树模型中。pureXML以节点和子树（而非文档级）的粒度存储XML qq在数据库中，物理存储层的主要存储单元是节点。每个节点中保存了到父节点和子节点的连接。因此，在进行层次遍历或者结构连接操作时，效率都非常高。可以在不更新整个文档的前提下，增加、减少、或修改节点，并将节点重新存储到其它的页中。pureXML所提供的XML数据的底层存储支持，使得DB2能够更有效地处理XML层次数据 8.3 DB产品中的XMLnnDB2中的pureXMLqq索引方面：XML数据被格式化为缓冲数据页，以便快速导航和执行查询以及简化索引编制。DB2支持在XML列上建立路径特定的索引，因此元素和属性常用作谓词且可以编制跨文档连接的索引，从而高效地管理海量XML文档、提供高查询性能。DB2还通过Net Search Extender为XML数据提供全文检索，可以对完整的或者部分文档建立全文索引 qq查询方面：DB2为XML数据的检索提供了全面的支持，包括使用常规SQL, SQL/XML, XQuery以及嵌入SQL的XQuery，以实现层次数据的查询、更新，实现关系数据和层次数据的集成


pureXML的混合数据管理模式



